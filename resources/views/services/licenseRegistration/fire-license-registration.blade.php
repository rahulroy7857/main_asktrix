@extends('layouts.app')

@section('title', 'Fire License Registration with Asktrix - Fire Safety Compliance')

@section('styles')
<!-- intl-tel-input CSS -->
<link rel="stylesheet" href="https://cdn.tutorialjinni.com/intl-tel-input/17.0.8/css/intlTelInput.css"/>
<style>
    .Asktrix-blue {
        color: #1a237e;
    }
    .Asktrix-light-blue {
        color: #42a5f5;
    }
    .Asktrix-green {
        color: #4caf50;
    }
    .bg-Asktrix-blue {
        background-color: #1a237e;
    }
    .bg-Asktrix-light-blue {
        background-color: #42a5f5;
    }
    .bg-Asktrix-green {
        background-color: #4caf50;
    }
    .border-Asktrix-green {
        border-color: #4caf50;
    }
    .form-sidebar {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border: 2px solid #4caf50;
        border-radius: 12px;
        position: sticky;
        top: 100px;
    }
    .faq-item {
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        margin-bottom: 8px;
        overflow: hidden;
    }
    .faq-question {
        background: #f8f9fa;
        padding: 16px 20px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
    }
    .faq-question:hover {
        background: #e9ecef;
    }
    .faq-answer {
        padding: 0 20px;
        max-height: 0;
        overflow: hidden;
        transition: all 0.3s ease;
        background: white;
    }
    .faq-answer.active {
        padding: 20px;
        max-height: 500px;
    }
    .faq-icon {
        transition: transform 0.3s ease;
    }
    .faq-icon.rotated {
        transform: rotate(180deg);
    }
    .content-section {
        margin-bottom: 24px;
    }
    
    @media (min-width: 768px) {
        .content-section {
            margin-bottom: 40px;
        }
    }
        margin-bottom: 24px;
    }
    .content-section h2 {
        color: #1a237e;
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 16px;
    }
    
    @media (min-width: 768px) {
        .content-section h2 {
            font-size: 28px;
            margin-bottom: 20px;
        }
    }
    .content-section h3 {
        color: #1a237e;
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 12px;
    }
    
    @media (min-width: 768px) {
        .content-section h3 {
            font-size: 22px;
            margin-bottom: 16px;
        }
    }
    .content-section p {
        color: #374151;
        line-height: 1.7;
        margin-bottom: 16px;
    }
    .content-section ul {
        margin-bottom: 20px;
    }
    .content-section li {
        color: #374151;
        margin-bottom: 8px;
        line-height: 1.6;
        position: relative;
        padding-left: 20px;
    }
    .content-section li::before {
        content: "■";
        color: #1a237e;
        font-size: 12px;
        position: absolute;
        left: 0;
        top: 0;
    }
    .price-highlight {
        font-size: 24px;
        font-weight: 700;
        color: #4caf50;
    }
    
    @media (min-width: 768px) {
        .price-highlight {
            font-size: 32px;
        }
    }
    .scroll-to-top-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        background: #42a5f5;
        color: white;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        transition: all 0.3s ease;
        z-index: 1000;
    }
    .scroll-to-top-btn:hover {
        background: #1a237e;
        transform: translateY(-2px);
    }

    /* Custom styling for intl-tel-input to match our design */
    .iti {
        width: 100%;
    }

    .iti__country-list {
        border: 1px solid #d1d5db !important;
        border-radius: 0.5rem !important;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
        max-height: 200px !important;
    }

    .iti__country {
        padding: 8px 12px !important;
        border-bottom: 1px solid #f3f4f6 !important;
    }

    .iti__country:last-child {
        border-bottom: none !important;
    }

    .iti__country:hover {
        background-color: #eff6ff !important;
    }

    .iti__country.iti__highlight {
        background-color: #dbeafe !important;
    }

    .iti__flag {
        border-radius: 2px !important;
    }

    .iti__selected-flag {
        border-right: 1px solid #d1d5db !important;
        background-color: #f9fafb !important;
        border-radius: 0.5rem 0 0 0.5rem !important;
    }

    .iti__selected-flag:hover {
        background-color: #f3f4f6 !important;
    }

    .iti__arrow {
        border-top-color: #6b7280 !important;
    }

    .iti__search-input {
        border: 1px solid #d1d5db !important;
        border-radius: 0.375rem !important;
        padding: 8px 12px !important;
        font-size: 14px !important;
    }

    .iti__search-input:focus {
        border-color: #6b7280 !important;
        box-shadow: 0 0 0 1px #6b7280 !important;
        outline: none !important;
    }

    .iti__search-input:focus-visible {
        border-color: #4caf50 !important;
        box-shadow: 0 0 0 1px #4caf50 !important;
        outline: none !important;
    }

    /* General form input focus styling */
    input:focus, textarea:focus {
        border-color: #6b7280 !important;
        box-shadow: 0 0 0 1px #6b7280 !important;
        outline: none !important;
    }

    /* Focus-visible styling with green color */
    input:focus-visible, textarea:focus-visible {
        border-color: #4caf50 !important;
        box-shadow: 0 0 0 1px #4caf50 !important;
        outline: none !important;
    }

    /* Input field styling */
    #mobile {
        border-left: none !important;
        border-radius: 0 0.5rem 0.5rem 0 !important;
    }

    #mobile:focus {
        border-color: #6b7280 !important;
        box-shadow: 0 0 0 1px #6b7280 !important;
        outline: none !important;
    }

    #mobile:focus-visible {
        border-color: #4caf50 !important;
        box-shadow: 0 0 0 1px #4caf50 !important;
        outline: none !important;
    }
</style>
@endsection

@section('content')
<div class="min-h-screen bg-white">
    <!-- Main Content Container -->
    <div class="max-w-7xl mx-auto px-4 md:px-6 py-6 md:py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 md:p-6 md:gap-8">
            <!-- Main Content -->
            <div class="lg:col-span-2">
                <!-- Page Title -->
                <div class="mb-6 md:mb-8">
                    <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold Asktrix-blue mb-6 leading-tight">
                        Fire License Registration with Asktrix
                    </h1>
                    <p class="text-sm sm:text-base md:text-lg text-gray-700 leading-relaxed">
                        A fire license is a legal document that ensures a building or facility complies with fire safety regulations and standards. It is essential for businesses dealing with flammable materials, crowded spaces, or specific industry regulations to obtain this license for legal operation and safety assurance.
                    </p>
                </div>

                <!-- Importance of a Fire License -->
                <div class="content-section">
                    <h2>Importance of a Fire License</h2>
                    <ul class="space-y-3">
                        <li><strong>Safety Compliance:</strong> Ensures adherence to fire safety laws and regulations set by local authorities.</li>
                        <li><strong>Risk Mitigation:</strong> Reduces the risk of fire hazards and enhances the safety of the premises.</li>
                        <li><strong>Insurance Requirement:</strong> Many insurance companies require a valid fire license for coverage.</li>
                        <li><strong>Credibility:</strong> Enhances the business's reputation and trustworthiness among customers and stakeholders.</li>
                    </ul>
                </div>

                <!-- Types of Establishments Requiring a Fire License -->
                <div class="content-section">
                    <h2>Types of Establishments Requiring a Fire License</h2>
                    <p class="mb-3 md:mb-4">Certain businesses are mandated to obtain a fire license based on their nature of operations, occupancy, and potential fire hazards.</p>
                    <ul class="space-y-3">
                        <li><strong>Manufacturing Units:</strong> Factories producing chemicals, textiles, or any combustible materials.</li>
                        <li><strong>Hospitality Sector:</strong> Hotels, restaurants, bars, and clubs that accommodate a large number of people.</li>
                        <li><strong>Educational Institutions:</strong> Schools, colleges, and training centers that have multiple classrooms and gathering areas.</li>
                        <li><strong>Healthcare Facilities:</strong> Hospitals, clinics, and nursing homes with patients who require special safety measures.</li>
                        <li><strong>Shopping Malls and Retail Outlets:</strong> Places with high foot traffic that require crowd management and safety protocols.</li>
                        <li><strong>Warehouses and Storage Facilities:</strong> Facilities storing flammable or hazardous materials.</li>
                        <li><strong>Event Venues:</strong> Auditoriums, exhibition halls, and convention centers that host large gatherings.</li>
                        <li><strong>Residential Buildings:</strong> High-rise buildings and residential complexes may also require a fire license based on occupancy.</li>
                    </ul>
                </div>

                <!-- Applicable States in India -->
                <div class="content-section">
                    <h2>Applicable States in India</h2>
                    <p class="mb-3 md:mb-4">Fire safety regulations and requirements vary by state and municipality. Here are the states/UTs and their relevant authorities:</p>
                    <ul class="space-y-2">
                        <li><strong>Maharashtra:</strong> Issued by the Mumbai Fire Brigade or local fire authorities.</li>
                        <li><strong>Delhi:</strong> Issued by the Delhi Fire Service.</li>
                        <li><strong>Karnataka:</strong> Issued by the Karnataka Fire and Emergency Services.</li>
                        <li><strong>Tamil Nadu:</strong> Issued by the Tamil Nadu Fire and Rescue Services.</li>
                        <li><strong>Gujarat:</strong> Issued by the Gujarat Fire Prevention and Life Safety Measures.</li>
                        <li><strong>West Bengal:</strong> Issued by the West Bengal Fire Service.</li>
                        <li><strong>Uttar Pradesh:</strong> Issued by the Uttar Pradesh Fire Service.</li>
                        <li><strong>Rajasthan:</strong> Issued by the Rajasthan Fire Service.</li>
                        <li><strong>Punjab:</strong> Issued by the Punjab Fire Service.</li>
                        <li><strong>Haryana:</strong> Issued by the Haryana Fire Service.</li>
                        <li><strong>Kerala:</strong> Issued by the Kerala Fire and Rescue Services.</li>
                        <li><strong>Andhra Pradesh:</strong> Issued by the Andhra Pradesh Fire Service.</li>
                        <li><strong>Telangana:</strong> Issued by the Telangana Fire Service.</li>
                        <li><strong>Madhya Pradesh:</strong> Issued by the Madhya Pradesh Fire Service.</li>
                        <li><strong>Bihar:</strong> Issued by the Bihar Fire Service.</li>
                        <li><strong>Odisha:</strong> Issued by the Odisha Fire Service.</li>
                        <li><strong>Assam:</strong> Issued by the Assam Fire Service.</li>
                        <li><strong>Jharkhand:</strong> Issued by the Jharkhand Fire Service.</li>
                        <li><strong>Chhattisgarh:</strong> Issued by the Chhattisgarh Fire Service.</li>
                        <li><strong>Himachal Pradesh:</strong> Issued by the Himachal Pradesh Fire Service.</li>
                        <li><strong>Uttarakhand:</strong> Issued by the Uttarakhand Fire Service.</li>
                        <li><strong>Goa:</strong> Issued by the Goa Fire Service.</li>
                        <li><strong>Manipur:</strong> Issued by the Manipur Fire Service.</li>
                        <li><strong>Meghalaya:</strong> Issued by the Meghalaya Fire Service.</li>
                        <li><strong>Mizoram:</strong> Issued by the Mizoram Fire Service.</li>
                        <li><strong>Nagaland:</strong> Issued by the Nagaland Fire Service.</li>
                        <li><strong>Tripura:</strong> Issued by the Tripura Fire Service.</li>
                        <li><strong>Sikkim:</strong> Issued by the Sikkim Fire Service.</li>
                    </ul>
                </div>

                <!-- Fire License Registration Process with Asktrix -->
                <div class="content-section">
                    <h2>Fire License Registration Process with Asktrix</h2>
                    <ul class="space-y-3">
                        <li><strong>Consultation:</strong> Contact Asktrix for a detailed consultation regarding your fire license requirements.</li>
                        <li><strong>Document Collection:</strong> Gather necessary documents, including building plans, occupancy details, fire safety measures, and identity proof.</li>
                        <li><strong>Application Preparation:</strong> Asktrix will assist in preparing the fire license application and compiling necessary documentation.</li>
                        <li><strong>Submission:</strong> Submit the application to the local fire department or relevant authority.</li>
                        <li><strong>Inspection:</strong> The local fire authority may conduct an inspection of the premises to verify compliance with fire safety standards.</li>
                        <li><strong>Fee Payment:</strong> Pay the applicable fees as per local regulations.</li>
                        <li><strong>License Issuance:</strong> Upon approval and successful inspection, you will receive your fire license.</li>
                    </ul>
                </div>

                <!-- Compliance Requirements -->
                <div class="content-section">
                    <h2>Compliance Requirements</h2>
                    <ul class="space-y-3">
                        <li><strong>Renewal:</strong> Fire licenses must be renewed periodically as per local regulations, typically every year or as specified.</li>
                        <li><strong>Regular Inspections:</strong> Ensure regular fire safety inspections and maintenance of fire safety equipment.</li>
                        <li><strong>Safety Drills:</strong> Conduct regular fire drills and training for employees to prepare for emergencies.</li>
                    </ul>
                </div>

                <!-- Benefits of Obtaining a Fire License -->
                <div class="content-section">
                    <h2>Benefits of Obtaining a Fire License</h2>
                    <ul class="space-y-3">
                        <li><strong>Safety Assurance:</strong> Provides assurance of safety standards for employees and customers.</li>
                        <li><strong>Legal Protection:</strong> Operate your business legally and avoid penalties.</li>
                        <li><strong>Insurance Eligibility:</strong> Meet insurance requirements for property and liability coverage.</li>
                        <li><strong>Increased Credibility:</strong> Enhances the credibility and reputation of your business in the marketplace.</li>
                    </ul>
                </div>

                <!-- FAQ Section -->
                <div class="content-section">
                    <div class="mb-3 md:mb-4">
                        <span class="text-sm font-medium text-gray-500 uppercase tracking-wide">FAQ</span>
                        <h2 class="text-xl sm:text-2xl md:text-3xl font-bold Asktrix-blue">Frequently Asked Questions</h2>
                    </div>
                    <p class="mb-6 md:mb-8 text-gray-600">
                        These FAQs cover essential details like eligibility, required documents, process steps, benefits, costs, and timelines for fire license registration.
                    </p>

                    <div class="space-y-3 md:space-y-4">
                        <!-- FAQ Item 1 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">What is a fire license?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>A fire license is a legal document issued by local fire authorities that certifies a building or facility complies with fire safety regulations and standards. It ensures the premises meet safety requirements for fire prevention and emergency response.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 2 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">Who needs a fire license?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>Businesses dealing with flammable materials, crowded spaces, manufacturing units, hospitality sector, educational institutions, healthcare facilities, shopping malls, warehouses, event venues, and high-rise residential buildings typically require fire licenses.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 3 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">How long does it take to obtain a fire license?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>The process typically takes 15-30 days from application submission to license issuance, depending on the local authority's processing time and inspection requirements.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 4 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">What documents are required for fire license registration?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>Required documents include building plans, occupancy certificate, fire safety equipment details, identity proof, address proof, business registration documents, and fire safety compliance certificates.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 5 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">What happens if I do not obtain a fire license?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>Operating without a required fire license can result in penalties, closure orders, insurance claim rejections, and legal consequences. It also poses significant safety risks to occupants and property.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 6 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">Can I apply for a fire license online?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>Many states now offer online application facilities, but physical inspection of premises is mandatory. Asktrix can help you navigate the online application process and prepare for inspections.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 7 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">What is the cost of obtaining a fire license?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>Fire license fees vary by state and building type, typically ranging from ₹2,000 to ₹10,000. Additional costs may include fire safety equipment installation and compliance certificates.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 8 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">How often do I need to renew my fire license?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>Fire licenses typically need annual renewal, though some states may have different renewal periods. Regular inspections and compliance verification are required during renewal.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 9 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">Can I transfer my fire license to a new business location?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>Fire licenses are location-specific and cannot be transferred. You must apply for a new fire license for the new location, as each premises has unique fire safety requirements.</p>
                            </div>
                        </div>

                        <!-- FAQ Item 10 -->
                        <div class="faq-item">
                            <div class="faq-question" onclick="toggleFAQ(this)">
                                <span class="font-semibold">What should I do if I fail a fire safety inspection?</span>
                                <i class="fas fa-chevron-down faq-icon"></i>
                            </div>
                            <div class="faq-answer">
                                <p>If you fail an inspection, address the identified deficiencies, implement required fire safety measures, and request a re-inspection. Asktrix can help you prepare for inspections and ensure compliance.</p>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 p-4 md:p-6 bg-blue-50 rounded-lg">
                        <p class="text-gray-700">
                            By obtaining your fire license through Asktrix, you can ensure compliance with fire safety regulations and enhance the safety of your business environment. Let us help you navigate the fire license registration process efficiently.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Sidebar Form -->
            <div class="lg:col-span-1">
                <div class="form-sidebar p-4 md:p-6">
                    <h3 class="text-xl font-bold Asktrix-blue mb-3 md:mb-4">Clear your doubts</h3>
                    <div class="mb-3 md:mb-4">
                        <span class="text-sm text-gray-600">Price Starts Onwards</span>
                        <div class="price-highlight">₹7,899 INR</div>
                    </div>
                    
                    <!-- AJAX Message Container -->
                    <div id="ajaxMessage" class="hidden mb-6"></div>
                    
                    @if(session('success'))
                        <div class="bg-green-100 border border-green-400 text-green-700 px-3 md:px-4 py-2 md:py-3 rounded mb-6">
                            {{ session('success') }}
                        </div>
                    @endif

                    @if(session('error'))
                        <div class="bg-red-100 border border-red-400 text-red-700 px-3 md:px-4 py-2 md:py-3 rounded mb-6">
                            {{ session('error') }}
                        </div>
                    @endif

                    @if($errors->any())
                        <div class="bg-red-100 border border-red-400 text-red-700 px-3 md:px-4 py-2 md:py-3 rounded mb-6">
                            <ul class="list-disc list-inside">
                                @foreach($errors->all() as $error)
                                    <li>{{ $error }}</li>
                                @endforeach
                            </ul>
                        </div>
                    @endif
                    
                    <form id="contactForm" action="{{ route('contact.submit') }}" method="POST" class="space-y-3 md:space-y-4">
                        @csrf
                        <div>
                            <input type="hidden" 
                                   id="service_type" 
                                   name="service_type" 
                                   value="fire-license-registration">
                        </div>
                        
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-700 mb-2">Name</label>
                            <input type="text" 
                                   id="name" 
                                   name="name" 
                                   required
                                   value="{{ old('name') }}"
                                   class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-Asktrix-green focus:border-transparent mobile-form-input @error('name') border-red-500 @enderror"
                                   placeholder="Enter your name">
                        </div>
                        
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                            <input type="email" 
                                   id="email" 
                                   name="email" 
                                   required
                                   value="{{ old('email') }}"
                                   class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-Asktrix-green focus:border-transparent mobile-form-input @error('email') border-red-500 @enderror"
                                   placeholder="Enter your email">
                        </div>
                        
                        <div>
                            <label for="mobile" class="block text-sm font-medium text-gray-700 mb-2">Mobile</label>
                            <input type="tel" 
                                   id="mobile" 
                                   name="mobile" 
                                   required
                                   value="{{ old('mobile') }}"
                                   class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-Asktrix-green focus:border-transparent mobile-form-input @error('mobile') border-red-500 @enderror"
                                   placeholder="Enter your mobile number">
                        </div>
                        
                        <div>
                            <label for="query" class="block text-sm font-medium text-gray-700 mb-2">Tell us more about your Query</label>
                            <textarea id="query" 
                                      name="query" 
                                      rows="3" 
                                      required
                                      class="w-full px-3 md:px-4 py-2 md:py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-Asktrix-green focus:border-transparent mobile-form-input @error('query') border-red-500 @enderror"
                                      placeholder="Describe your requirements...">{{ old('query') }}</textarea>
                        </div>
                        
                        <button type="submit" 
                                id="submitBtn"
                                class="w-full bg-Asktrix-green hover:bg-green-600 text-white font-semibold py-2 md:py-3 px-4 md:px-6 rounded-lg transition-colors">
                            <span id="submitText">Pay Now</span>
                            <span id="loadingText" class="hidden">
                                <i class="fas fa-spinner fa-spin mr-2"></i>Submitting...
                            </span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scroll to Top Button -->
<button class="scroll-to-top-btn" onclick="scrollToTop()" style="display: none;">
    <i class="fas fa-chevron-up"></i>
</button>
@endsection

@section('scripts')
<!-- intl-tel-input JS -->
<script src="https://cdn.tutorialjinni.com/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
<script>
    $(document).ready(function() {
        // Initialize intl-tel-input on mobile input
        const input = document.querySelector("#mobile");
        const iti = window.intlTelInput(input, {
            initialCountry: "in", // Default to India
            preferredCountries: ['in', 'us', 'gb', 'ca', 'au', 'de', 'fr', 'jp', 'cn', 'br'],
            onlyCountries: ['in', 'us', 'gb', 'ca', 'au', 'de', 'fr', 'jp', 'cn', 'br', 'ru', 'it', 'es', 'nl', 'se', 'no', 'dk', 'fi', 'ch', 'at', 'be', 'pl', 'cz', 'hu', 'pt', 'gr', 'tr', 'il', 'za', 'eg', 'ng', 'ke', 'ma', 'tn', 'ae', 'sa', 'qa', 'kw', 'bh', 'om', 'jo', 'lb', 'sg', 'my', 'th', 'vn', 'id', 'ph', 'kr', 'tw', 'hk', 'mo', 'nz', 'zw', 'gh', 'et', 'ug', 'tz', 'mx', 'ar', 'cl', 'co', 'pe', 've', 'ec', 'bo', 'py', 'uy'],
            autoHideDialCode: false,
            nationalMode: false,
            separateDialCode: true,
            utilsScript: "https://cdn.tutorialjinni.com/intl-tel-input/17.0.8/js/utils.js"
        });

        // AJAX Form Submission
        $('#contactForm').on('submit', function(e) {
            e.preventDefault();
            
            // Validate phone number first
            if (input.value.trim()) {
                if (!iti.isValidNumber()) {
                    showMessage('Please enter a valid phone number', 'error');
                    return false;
                }
                
                // Get country data and separate mobile number from country code
                const countryData = iti.getSelectedCountryData();
                const fullNumber = iti.getNumber();
                const mobileNumber = iti.getNumber().replace('+' + countryData.dialCode, '');
                
                // Add/update country code
                if (!$('input[name="country_code"]').length) {
                    $('<input>').attr({
                        type: 'hidden',
                        name: 'country_code',
                        value: '+' + countryData.dialCode
                    }).appendTo(this);
                } else {
                    $('input[name="country_code"]').val('+' + countryData.dialCode);
                }
                
                // Update mobile input with only the mobile number (without country code)
                $('#mobile').val(mobileNumber);
            }
            
            // Show loading state
            showLoading(true);
            
            // Get form data
            const formData = new FormData(this);
            
            // Submit via AJAX
            $.ajax({
                url: $(this).attr('action'),
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                headers: {
                    'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
                },
                success: function(response) {
                    showLoading(false);
                    if (response.success) {
                        showMessage(response.message, 'success');
                        $('#contactForm')[0].reset();
                        // Reset phone input
                        iti.setNumber('');
                    } else {
                        showMessage(response.message, 'error');
                    }
                },
                error: function(xhr) {
                    showLoading(false);
                    if (xhr.status === 422) {
                        // Validation errors
                        const errors = xhr.responseJSON.errors;
                        let errorMessage = 'Please correct the following errors:\n';
                        for (let field in errors) {
                            errorMessage += errors[field][0] + '\n';
                        }
                        showMessage(errorMessage, 'error');
                    } else {
                        showMessage('Sorry, there was an error submitting your request. Please try again later.', 'error');
                    }
                }
            });
        });

        // Handle country change
        input.addEventListener('countrychange', function() {
            const countryData = iti.getSelectedCountryData();
            console.log('Country changed to:', countryData.name, '+' + countryData.dialCode);
        });

        // Handle input validation
        input.addEventListener('blur', function() {
            if (input.value.trim()) {
                if (iti.isValidNumber()) {
                    input.classList.remove('error');
                } else {
                    input.classList.add('error');
                }
            }
        });

        // Helper functions
        function showLoading(show) {
            if (show) {
                $('#submitBtn').prop('disabled', true);
                $('#submitText').addClass('hidden');
                $('#loadingText').removeClass('hidden');
            } else {
                $('#submitBtn').prop('disabled', false);
                $('#submitText').removeClass('hidden');
                $('#loadingText').addClass('hidden');
            }
        }

        function showMessage(message, type) {
            const messageDiv = $('#ajaxMessage');
            messageDiv.removeClass('hidden bg-green-100 border-green-400 text-green-700 bg-red-100 border-red-400 text-red-700');
            
            if (type === 'success') {
                messageDiv.addClass('bg-green-100 border border-green-400 text-green-700 px-3 md:px-4 py-2 md:py-3 rounded');
            } else {
                messageDiv.addClass('bg-red-100 border border-red-400 text-red-700 px-3 md:px-4 py-2 md:py-3 rounded');
            }
            
            messageDiv.html(message);
            
            // Auto-hide success messages after 5 seconds
            if (type === 'success') {
                setTimeout(function() {
                    messageDiv.addClass('hidden');
                }, 5000);
            }
        }
    });

    function toggleFAQ(element) {
        const answer = element.nextElementSibling;
        const icon = element.querySelector('.faq-icon');
        
        // Close all other FAQ items
        document.querySelectorAll('.faq-answer').forEach(item => {
            if (item !== answer) {
                item.classList.remove('active');
            }
        });
        
        document.querySelectorAll('.faq-icon').forEach(item => {
            if (item !== icon) {
                item.classList.remove('rotated');
            }
        });
        
        // Toggle current FAQ item
        answer.classList.toggle('active');
        icon.classList.toggle('rotated');
    }

    function scrollToTop() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }

    // Show/hide scroll to top button
    window.addEventListener('scroll', function() {
        const scrollBtn = document.querySelector('.scroll-to-top-btn');
        if (window.pageYOffset > 300) {
            scrollBtn.style.display = 'flex';
        } else {
            scrollBtn.style.display = 'none';
        }
    });

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
</script>
@endsection
